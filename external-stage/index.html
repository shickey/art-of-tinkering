<!DOCTYPE html>
<html>
<head>
  <title>Stage</title>
</head>
<style type="text/css">
  body {
    margin: 0;
    padding: 0;
    background-color: #000;
    width: 100%;
    height: 100vh;
  }

  #container {
		height: 100%;
		width: 100%;
  }

  #helper {
		display: inline-block;
    height: 100%;
    vertical-align: middle;
  }

  img#stage {
		min-width: 100%;
		background: #3A6F9A;
    vertical-align: middle;
  }
</style>
<body>
  <div id="container">
		<span id="helper"></span><img src="#" id="stage" />
	</div>
</body>
<script type="text/javascript">
  var channel = new BroadcastChannel('stage-image');
  var imageTag = document.getElementById('stage');
  console.log(imageTag);
  channel.onmessage = (msg) => {
    imageTag.src = msg.data.dataURI;
  }

  var addConnection = function(connection) {
    connection.onmessage = function (message) {
			console.log(message.data);
			imageTag.src = message.data
    };
  };

  navigator.presentation.receiver.connectionList.then(function (list) {
    list.connections.map(function (connection) {
      addConnection(connection);
    });
    list.onconnectionavailable = function (evt) {
      addConnection(evt.connection);
    };
  });
</script>
</html>
